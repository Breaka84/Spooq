<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="765px" preserveAspectRatio="none" style="width:607px;height:765px;" version="1.1" viewBox="0 0 607 765" width="607px" zoomAndPan="magnify"><defs><filter height="300%" id="f12k7qve9hwlel" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="312" cy="20" fill="#000000" filter="url(#f12k7qve9hwlel)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="307" x="158.5" y="50"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="168" x="168.5" y="71.1387">repartition DataFrame to</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="343.5" y="71.1387">repartition_size</text><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="328" x="148" y="196.3711"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="91" x="158" y="217.5098">add/overwrite</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="256" y="217.5098">column_name</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="340" y="217.5098">with</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="375" y="217.5098">default_value</text><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="237" x="193.5" y="265.3398"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="28" x="203.5" y="286.4785">cast</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="238.5" y="286.4785">column_name</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="14" x="322.5" y="286.4785">as</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="343.5" y="286.4785">column_type</text><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="112.5,147.9688,511.5,147.9688,523.5,159.9688,511.5,171.9688,112.5,171.9688,100.5,159.9688,112.5,147.9688" style="stroke: #383838; stroke-width: 1.5;"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="316" y="182.1792">true</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="112.5" y="163.7769">column_name</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="112" x="196.5" y="163.7769">not in DataFrame</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="14" x="315.5" y="163.7769">or</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="336.5" y="163.7769"/><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="175" x="336.5" y="163.7769">overwrite_partition_value</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="523.5" y="157.3745">false</text><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="312,319.3086,324,331.3086,312,343.3086,300,331.3086,312,319.3086" style="stroke: #383838; stroke-width: 1.5;"/><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="140.5,103.9688,483.5,103.9688,495.5,115.9688,483.5,127.9688,140.5,127.9688,128.5,115.9688,140.5,103.9688" style="stroke: #383838; stroke-width: 1.5;"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21" x="140.5" y="119.7769">for</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="140" x="168.5" y="119.7769">partition_definition</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="315.5" y="119.7769">in</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="147" x="336.5" y="119.7769">partition_definitions</text><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="207,385.3086,417,385.3086,429,397.3086,417,409.3086,207,409.3086,195,397.3086,207,385.3086" style="stroke: #383838; stroke-width: 1.5;"/><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="207" y="401.1167">full_table_name</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="319" y="401.1167">already exists</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="167" y="394.7144">true</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="429" y="394.7144">false</text><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="230" x="20.5" y="419.3086"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="210" x="30.5" y="440.4473">assert DataFrame schema equals</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="58.5" y="454.416">full_table_name</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="42" x="170.5" y="454.416">schema</text><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="251" x="10" y="550.6484"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="119" x="20" y="571.7871">drop partition in</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="146" y="571.7871">full_table_name</text><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="83,502.2461,188,502.2461,200,514.2461,188,526.2461,83,526.2461,71,514.2461,83,502.2461" style="stroke: #383838; stroke-width: 1.5;"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="139.5" y="536.4565">true</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="83" y="518.0542">clear_partition</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="200" y="511.6519">false</text><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="135.5,604.6172,147.5,616.6172,135.5,628.6172,123.5,616.6172,135.5,604.6172" style="stroke: #383838; stroke-width: 1.5;"/><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="429,419.3086,548,419.3086,560,431.3086,548,443.3086,429,443.3086,417,431.3086,429,419.3086" style="stroke: #383838; stroke-width: 1.5;"/><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="429" y="435.1167">auto_create_table</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="389" y="428.7144">true</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="560" y="428.7144">false</text><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="188" x="313" y="453.3086"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="133" x="340.5" y="474.4473">partition DataFrame</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="14" x="323" y="488.416">by</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="147" x="344" y="488.416">partition_definitions</text><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="174" x="320" y="536.2461"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="42" x="330" y="557.3848">create</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="379" y="557.3848">full_table_name</text><ellipse cx="570" cy="463.3086" fill="#FFFFFF" filter="url(#f12k7qve9hwlel)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 2.5;" x1="563.8128" x2="576.1872" y1="457.1214" y2="469.4958"/><line style="stroke: #000000; stroke-width: 2.5;" x1="576.1872" x2="563.8128" y1="457.1214" y2="469.4958"/><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="312,634.6172,324,646.6172,312,658.6172,300,646.6172,312,634.6172" style="stroke: #383838; stroke-width: 1.5;"/><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="209" x="207.5" y="678.6172"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="77" x="217.5" y="699.7559">insert into</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="301.5" y="699.7559">full_table_name</text><ellipse cx="312" cy="743.5859" fill="#FFFFFF" filter="url(#f12k7qve9hwlel)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="312" cy="743.5859" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="312" x2="312" y1="30" y2="50"/><polygon fill="#383838" points="308,40,312,50,316,40,312,44" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="312" x2="312" y1="230.3398" y2="265.3398"/><polygon fill="#383838" points="308,255.3398,312,265.3398,316,255.3398,312,259.3398" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="312" x2="312" y1="171.9688" y2="196.3711"/><polygon fill="#383838" points="308,186.3711,312,196.3711,316,186.3711,312,190.3711" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="523.5" x2="535.5" y1="159.9688" y2="159.9688"/><polygon fill="#383838" points="531.5,237.8398,535.5,247.8398,539.5,237.8398,535.5,241.8398" style="stroke: #383838; stroke-width: 1.5;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="535.5" x2="535.5" y1="159.9688" y2="331.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="535.5" x2="324" y1="331.3086" y2="331.3086"/><polygon fill="#383838" points="334,327.3086,324,331.3086,334,335.3086,330,331.3086" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="312" x2="312" y1="299.3086" y2="319.3086"/><polygon fill="#383838" points="308,309.3086,312,319.3086,316,309.3086,312,313.3086" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="312" x2="312" y1="127.9688" y2="147.9688"/><polygon fill="#383838" points="308,137.9688,312,147.9688,316,137.9688,312,141.9688" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="312" x2="312" y1="343.3086" y2="353.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="312" x2="547.5" y1="353.3086" y2="353.3086"/><polygon fill="#383838" points="543.5,245.8398,547.5,235.8398,551.5,245.8398,547.5,241.8398" style="stroke: #383838; stroke-width: 1.5;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="547.5" x2="547.5" y1="115.9688" y2="353.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="547.5" x2="495.5" y1="115.9688" y2="115.9688"/><polygon fill="#383838" points="505.5,111.9688,495.5,115.9688,505.5,119.9688,501.5,115.9688" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="128.5" x2="88.5" y1="115.9688" y2="115.9688"/><polygon fill="#383838" points="84.5,231.8398,88.5,241.8398,92.5,231.8398,88.5,235.8398" style="stroke: #383838; stroke-width: 1.5;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="88.5" x2="88.5" y1="115.9688" y2="365.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="88.5" x2="312" y1="365.3086" y2="365.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="312" x2="312" y1="365.3086" y2="385.3086"/><polygon fill="#383838" points="308,375.3086,312,385.3086,316,375.3086,312,379.3086" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="312" x2="312" y1="83.9688" y2="103.9688"/><polygon fill="#383838" points="308,93.9688,312,103.9688,316,93.9688,312,97.9688" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="135.5" x2="135.5" y1="526.2461" y2="550.6484"/><polygon fill="#383838" points="131.5,540.6484,135.5,550.6484,139.5,540.6484,135.5,544.6484" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="200" x2="271" y1="514.2461" y2="514.2461"/><polygon fill="#383838" points="267,557.6328,271,567.6328,275,557.6328,271,561.6328" style="stroke: #383838; stroke-width: 1.5;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="271" x2="271" y1="514.2461" y2="616.6172"/><line style="stroke: #383838; stroke-width: 1.5;" x1="271" x2="147.5" y1="616.6172" y2="616.6172"/><polygon fill="#383838" points="157.5,612.6172,147.5,616.6172,157.5,620.6172,153.5,616.6172" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="135.5" x2="135.5" y1="584.6172" y2="604.6172"/><polygon fill="#383838" points="131.5,594.6172,135.5,604.6172,139.5,594.6172,135.5,598.6172" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="135.5" x2="135.5" y1="467.2461" y2="502.2461"/><polygon fill="#383838" points="131.5,492.2461,135.5,502.2461,139.5,492.2461,135.5,496.2461" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="407" x2="407" y1="501.2461" y2="536.2461"/><polygon fill="#383838" points="403,526.2461,407,536.2461,411,526.2461,407,530.2461" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="417" x2="407" y1="431.3086" y2="431.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="407" x2="407" y1="431.3086" y2="453.3086"/><polygon fill="#383838" points="403,443.3086,407,453.3086,411,443.3086,407,447.3086" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="560" x2="570" y1="431.3086" y2="431.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="570" x2="570" y1="431.3086" y2="453.3086"/><polygon fill="#383838" points="566,443.3086,570,453.3086,574,443.3086,570,447.3086" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="407" x2="407" y1="570.2148" y2="646.6172"/><line style="stroke: #383838; stroke-width: 1.5;" x1="407" x2="324" y1="646.6172" y2="646.6172"/><polygon fill="#383838" points="334,642.6172,324,646.6172,334,650.6172,330,646.6172" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="195" x2="135.5" y1="397.3086" y2="397.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="135.5" x2="135.5" y1="397.3086" y2="419.3086"/><polygon fill="#383838" points="131.5,409.3086,135.5,419.3086,139.5,409.3086,135.5,413.3086" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="429" x2="488.5" y1="397.3086" y2="397.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="488.5" x2="488.5" y1="397.3086" y2="419.3086"/><polygon fill="#383838" points="484.5,409.3086,488.5,419.3086,492.5,409.3086,488.5,413.3086" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="135.5" x2="135.5" y1="628.6172" y2="646.6172"/><line style="stroke: #383838; stroke-width: 1.5;" x1="135.5" x2="300" y1="646.6172" y2="646.6172"/><polygon fill="#383838" points="290,642.6172,300,646.6172,290,650.6172,294,646.6172" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="312" x2="312" y1="658.6172" y2="678.6172"/><polygon fill="#383838" points="308,668.6172,312,678.6172,316,668.6172,312,672.6172" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="312" x2="312" y1="712.5859" y2="732.5859"/><polygon fill="#383838" points="308,722.5859,312,732.5859,316,722.5859,312,726.5859" style="stroke: #383838; stroke-width: 1.0;"/><!--MD5=[46aced2fe29653d84145e63acc2cc6f2]
@startuml

skinparam monochrome true
skinparam defaultFontname Bitstream Vera Sans Mono
skinparam defaultTextAlignment center

start
  :repartition DataFrame to **""repartition_size""**;
  while (for **""partition_definition""** in **""partition_definitions""**)
    if (**""column_name""** not in DataFrame //or// **""overwrite_partition_value""**) then (true)
      :add/overwrite **""column_name""** with **""default_value""**;
      :cast **""column_name""** as **""column_type""**;
    else (false)
    endif
  endwhile
  if (**""full_table_name""** already exists) then (true)
    :assert DataFrame schema equals
    **""full_table_name""** schema;
    if (**""clear_partition""**) then (true)
      :drop partition in **""full_table_name""**;
    else (false)
    endif
  else (false)
    if (**""auto_create_table""**) then (true)
    :partition DataFrame
    by **""partition_definitions""**;
    :create **""full_table_name""**;
    else (false)
      end
    endif
  endif
  :insert into **""full_table_name""**;

stop
@enduml

PlantUML version 1.2020.07(Sun Apr 19 13:42:40 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_242-b08
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>