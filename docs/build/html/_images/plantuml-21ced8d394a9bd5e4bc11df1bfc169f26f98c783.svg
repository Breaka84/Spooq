<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="771px" preserveAspectRatio="none" style="width:604px;height:771px;" version="1.1" viewBox="0 0 604 771" width="604px" zoomAndPan="magnify"><defs><filter height="300%" id="f12k7qve9hwlel" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="313" cy="20" fill="#000000" filter="url(#f12k7qve9hwlel)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="308" x="159" y="50"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="156" x="169" y="71.1387">repartition DataFrame to</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="329" y="71.1387">repartition_size</text><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="334" x="146" y="196.3711"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="156" y="217.5098">add/overwrite</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="88" x="245" y="217.5098">column_name</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="25" x="337" y="217.5098">with</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="366" y="217.5098">default_value</text><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="250" x="188" y="265.3398"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="27" x="198" y="286.4785">cast</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="88" x="229" y="286.4785">column_name</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="15" x="321" y="286.4785">as</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="88" x="340" y="286.4785">column_type</text><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="126,147.9688,500,147.9688,512,159.9688,500,171.9688,126,171.9688,114,159.9688,126,147.9688" style="stroke: #383838; stroke-width: 1.5;"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="317" y="182.1792">true</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="126" y="163.7769">column_name</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="207" y="163.7769">not in DataFrame</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="12" x="309" y="163.7769">or</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="325" y="163.7769"/><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="175" x="325" y="163.7769">overwrite_partition_value</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="512" y="157.3745">false</text><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="313,319.3086,325,331.3086,313,343.3086,301,331.3086,313,319.3086" style="stroke: #383838; stroke-width: 1.5;"/><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="150.5,103.9688,475.5,103.9688,487.5,115.9688,475.5,127.9688,150.5,127.9688,138.5,115.9688,150.5,103.9688" style="stroke: #383838; stroke-width: 1.5;"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="16" x="150.5" y="119.7769">for</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="140" x="170.5" y="119.7769">partition_definition</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="10" x="314.5" y="119.7769">in</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="147" x="328.5" y="119.7769">partition_definitions</text><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="218.5,385.3086,407.5,385.3086,419.5,397.3086,407.5,409.3086,218.5,409.3086,206.5,397.3086,218.5,385.3086" style="stroke: #383838; stroke-width: 1.5;"/><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="218.5" y="401.1167">full_table_name</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="327.5" y="401.1167">already exists</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="183.5" y="394.7144">true</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="419.5" y="394.7144">false</text><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="232" x="17.5" y="419.3086"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="212" x="27.5" y="440.4473">assert DataFrame schema equals</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="47" y="454.416">full_table_name</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="49" x="171" y="454.416">schema</text><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="245" x="11" y="550.6484"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="101" x="21" y="571.7871">drop partition in</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="126" y="571.7871">full_table_name</text><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="81,502.2461,186,502.2461,198,514.2461,186,526.2461,81,526.2461,69,514.2461,81,502.2461" style="stroke: #383838; stroke-width: 1.5;"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="137.5" y="536.4565">true</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="81" y="518.0542">clear_partition</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="198" y="511.6519">false</text><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="133.5,604.6172,145.5,616.6172,133.5,628.6172,121.5,616.6172,133.5,604.6172" style="stroke: #383838; stroke-width: 1.5;"/><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="433,419.3086,552,419.3086,564,431.3086,552,443.3086,433,443.3086,421,431.3086,433,419.3086" style="stroke: #383838; stroke-width: 1.5;"/><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="433" y="435.1167">auto_create_table</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="398" y="428.7144">true</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="564" y="428.7144">false</text><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="206" x="308" y="453.3086"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="126" x="348" y="474.4473">partition DataFrame</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="14" x="318" y="488.416">by</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="336" y="488.416">partition_definitions</text><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="185" x="318.5" y="536.2461"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="41" x="328.5" y="557.3848">create</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="373.5" y="557.3848">full_table_name</text><ellipse cx="574" cy="463.3086" fill="#FFFFFF" filter="url(#f12k7qve9hwlel)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 2.5;" x1="567.8128" x2="580.1872" y1="457.1214" y2="469.4958"/><line style="stroke: #000000; stroke-width: 2.5;" x1="580.1872" x2="567.8128" y1="457.1214" y2="469.4958"/><polygon fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" points="313,634.6172,325,646.6172,313,658.6172,301,646.6172,313,634.6172" style="stroke: #383838; stroke-width: 1.5;"/><rect fill="#F8F8F8" filter="url(#f12k7qve9hwlel)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="208" x="209" y="678.6172"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="64" x="219" y="699.7559">insert into</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="287" y="699.7559">full_table_name</text><ellipse cx="313" cy="743.5859" fill="#FFFFFF" filter="url(#f12k7qve9hwlel)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="313" cy="743.5859" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="313" x2="313" y1="30" y2="50"/><polygon fill="#383838" points="309,40,313,50,317,40,313,44" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="313" x2="313" y1="230.3398" y2="265.3398"/><polygon fill="#383838" points="309,255.3398,313,265.3398,317,255.3398,313,259.3398" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="313" x2="313" y1="171.9688" y2="196.3711"/><polygon fill="#383838" points="309,186.3711,313,196.3711,317,186.3711,313,190.3711" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="512" x2="524" y1="159.9688" y2="159.9688"/><polygon fill="#383838" points="520,237.8398,524,247.8398,528,237.8398,524,241.8398" style="stroke: #383838; stroke-width: 1.5;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="524" x2="524" y1="159.9688" y2="331.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="524" x2="325" y1="331.3086" y2="331.3086"/><polygon fill="#383838" points="335,327.3086,325,331.3086,335,335.3086,331,331.3086" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="313" x2="313" y1="299.3086" y2="319.3086"/><polygon fill="#383838" points="309,309.3086,313,319.3086,317,309.3086,313,313.3086" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="313" x2="313" y1="127.9688" y2="147.9688"/><polygon fill="#383838" points="309,137.9688,313,147.9688,317,137.9688,313,141.9688" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="313" x2="313" y1="343.3086" y2="353.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="313" x2="536" y1="353.3086" y2="353.3086"/><polygon fill="#383838" points="532,245.8398,536,235.8398,540,245.8398,536,241.8398" style="stroke: #383838; stroke-width: 1.5;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="536" x2="536" y1="115.9688" y2="353.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="536" x2="487.5" y1="115.9688" y2="115.9688"/><polygon fill="#383838" points="497.5,111.9688,487.5,115.9688,497.5,119.9688,493.5,115.9688" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="138.5" x2="102" y1="115.9688" y2="115.9688"/><polygon fill="#383838" points="98,231.8398,102,241.8398,106,231.8398,102,235.8398" style="stroke: #383838; stroke-width: 1.5;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="102" x2="102" y1="115.9688" y2="365.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="102" x2="313" y1="365.3086" y2="365.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="313" x2="313" y1="365.3086" y2="385.3086"/><polygon fill="#383838" points="309,375.3086,313,385.3086,317,375.3086,313,379.3086" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="313" x2="313" y1="83.9688" y2="103.9688"/><polygon fill="#383838" points="309,93.9688,313,103.9688,317,93.9688,313,97.9688" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="133.5" x2="133.5" y1="526.2461" y2="550.6484"/><polygon fill="#383838" points="129.5,540.6484,133.5,550.6484,137.5,540.6484,133.5,544.6484" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="198" x2="266" y1="514.2461" y2="514.2461"/><polygon fill="#383838" points="262,557.6328,266,567.6328,270,557.6328,266,561.6328" style="stroke: #383838; stroke-width: 1.5;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="266" x2="266" y1="514.2461" y2="616.6172"/><line style="stroke: #383838; stroke-width: 1.5;" x1="266" x2="145.5" y1="616.6172" y2="616.6172"/><polygon fill="#383838" points="155.5,612.6172,145.5,616.6172,155.5,620.6172,151.5,616.6172" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="133.5" x2="133.5" y1="584.6172" y2="604.6172"/><polygon fill="#383838" points="129.5,594.6172,133.5,604.6172,137.5,594.6172,133.5,598.6172" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="133.5" x2="133.5" y1="467.2461" y2="502.2461"/><polygon fill="#383838" points="129.5,492.2461,133.5,502.2461,137.5,492.2461,133.5,496.2461" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="411" x2="411" y1="501.2461" y2="536.2461"/><polygon fill="#383838" points="407,526.2461,411,536.2461,415,526.2461,411,530.2461" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="421" x2="411" y1="431.3086" y2="431.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="411" x2="411" y1="431.3086" y2="453.3086"/><polygon fill="#383838" points="407,443.3086,411,453.3086,415,443.3086,411,447.3086" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="564" x2="574" y1="431.3086" y2="431.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="574" x2="574" y1="431.3086" y2="453.3086"/><polygon fill="#383838" points="570,443.3086,574,453.3086,578,443.3086,574,447.3086" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="411" x2="411" y1="570.2148" y2="646.6172"/><line style="stroke: #383838; stroke-width: 1.5;" x1="411" x2="325" y1="646.6172" y2="646.6172"/><polygon fill="#383838" points="335,642.6172,325,646.6172,335,650.6172,331,646.6172" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="206.5" x2="133.5" y1="397.3086" y2="397.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="133.5" x2="133.5" y1="397.3086" y2="419.3086"/><polygon fill="#383838" points="129.5,409.3086,133.5,419.3086,137.5,409.3086,133.5,413.3086" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="419.5" x2="492.5" y1="397.3086" y2="397.3086"/><line style="stroke: #383838; stroke-width: 1.5;" x1="492.5" x2="492.5" y1="397.3086" y2="419.3086"/><polygon fill="#383838" points="488.5,409.3086,492.5,419.3086,496.5,409.3086,492.5,413.3086" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="133.5" x2="133.5" y1="628.6172" y2="646.6172"/><line style="stroke: #383838; stroke-width: 1.5;" x1="133.5" x2="301" y1="646.6172" y2="646.6172"/><polygon fill="#383838" points="291,642.6172,301,646.6172,291,650.6172,295,646.6172" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="313" x2="313" y1="658.6172" y2="678.6172"/><polygon fill="#383838" points="309,668.6172,313,678.6172,317,668.6172,313,672.6172" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="313" x2="313" y1="712.5859" y2="732.5859"/><polygon fill="#383838" points="309,722.5859,313,732.5859,317,722.5859,313,726.5859" style="stroke: #383838; stroke-width: 1.0;"/><!--MD5=[1b2e5bd01a2fe47934e2d94eb56f0e59]
@startuml

skinparam monochrome true
skinparam defaultFontname Bitstream Vera Sans Mono
skinparam defaultTextAlignment center

start
  :repartition DataFrame to **""repartition_size""**;
  while (for **""partition_definition""** in **""partition_definitions""**)
    if (**""column_name""** not in DataFrame //or// **""overwrite_partition_value""**) then (true)
      :add/overwrite **""column_name""** with **""default_value""**;
      :cast **""column_name""** as **""column_type""**;
    else (false)
    endif
  endwhile
  if (**""full_table_name""** already exists) then (true)
    :assert DataFrame schema equals
    **""full_table_name""** schema;
    if (**""clear_partition""**) then (true)
      :drop partition in **""full_table_name""**;
    else (false)
    endif
  else (false)
    if (**""auto_create_table""**) then (true)
    :partition DataFrame
    by **""partition_definitions""**;
    :create **""full_table_name""**;
    else (false)
      end
    endif
  endif
  :insert into **""full_table_name""**;

stop
@enduml

PlantUML version 1.2020.19(Mon Oct 12 17:10:01 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>