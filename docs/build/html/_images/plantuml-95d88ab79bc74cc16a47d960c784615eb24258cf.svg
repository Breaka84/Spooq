<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="692px" preserveAspectRatio="none" style="width:742px;height:692px;" version="1.1" viewBox="0 0 742 692" width="742px" zoomAndPan="magnify"><defs><filter height="300%" id="f84g3wdr7kob4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="348.5" cy="20" fill="#000000" filter="url(#f84g3wdr7kob4)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" height="75.875" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="132" x="282.5" y="50"/><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="292.5" y="71.1387">mapping</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="4" x="348.5" y="71.1387">:</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="4" x="292.5" y="85.1074">-</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="300.5" y="85.1074">source_column</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="4" x="292.5" y="99.0762">-</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="300.5" y="99.0762">name</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="4" x="292.5" y="113.0449">-</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="300.5" y="113.0449">data_type</text><polygon fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" points="267.5,201.5854,429.5,201.5854,441.5,213.5854,429.5,225.5854,267.5,225.5854,255.5,213.5854,267.5,201.5854" style="stroke: #383838; stroke-width: 1.5;"/><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="267.5" y="217.3936">data_type</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="95" x="334.5" y="217.3936">is Spark built-in?</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="235.5" y="210.9912">yes</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="441.5" y="210.9912">no</text><polygon fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" points="125.5,235.5854,216.5,235.5854,228.5,248.3901,216.5,261.1948,125.5,261.1948,113.5,248.3901,125.5,235.5854" style="stroke: #383838; stroke-width: 1.5;"/><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="125.5" y="245.7959">source_column</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="65" x="129.5" y="258.6006">is missing?</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="93.5" y="245.7959">yes</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="228.5" y="245.7959">no</text><rect fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="105" x="38" y="271.1948"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="49" x="48" y="292.3335">Value =</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="101" y="292.3335">None</text><rect fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="177" x="163" y="271.1948"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="49" x="173" y="292.3335">Value =</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="226" y="292.3335">source_column</text><polygon fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" points="171,311.1636,183,323.1636,171,335.1636,159,323.1636,171,311.1636" style="stroke: #383838; stroke-width: 1.5;"/><rect fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="121" x="110.5" y="370.1636"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="65" x="120.5" y="391.3022">rename to</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="189.5" y="391.3022">name</text><rect fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="142" x="100" y="439.1323"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="46" x="110" y="460.271">cast as</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="160" y="460.271">data_type</text><polygon fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" points="480.5,235.5854,571.5,235.5854,583.5,248.3901,571.5,261.1948,480.5,261.1948,468.5,248.3901,480.5,235.5854" style="stroke: #383838; stroke-width: 1.5;"/><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="480.5" y="245.7959">source_column</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="65" x="484.5" y="258.6006">is missing?</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="448.5" y="245.7959">yes</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="583.5" y="245.7959">no</text><rect fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="105" x="388" y="271.1948"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="49" x="398" y="292.3335">Value =</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="451" y="292.3335">None</text><rect fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="121" x="380" y="340.1636"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="65" x="390" y="361.3022">rename to</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="459" y="361.3022">name</text><rect fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="177" x="523" y="271.1948"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="49" x="533" y="292.3335">Value =</text><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="586" y="292.3335">source_column</text><rect fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" height="103.8125" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="181" x="521" y="340.1636"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="161" x="531" y="361.3022">_get_select_expression_↩</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="117" x="535" y="375.271">↪for_custom_type(</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="0" x="547" y="389.2397"/><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="547" y="389.2397">source_column</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="4" x="651" y="389.2397">,</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="0" x="547" y="403.2085"/><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="547" y="403.2085">name</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="4" x="579" y="403.2085">,</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="0" x="547" y="417.1772"/><text fill="#000000" font-family="monospace" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="547" y="417.1772">data_type</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="5" x="531" y="431.146">)</text><polygon fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" points="526,449.9761,538,461.9761,526,473.9761,514,461.9761,526,449.9761" style="stroke: #383838; stroke-width: 1.5;"/><polygon fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" points="348.5,479.9761,360.5,491.9761,348.5,503.9761,336.5,491.9761,348.5,479.9761" style="stroke: #383838; stroke-width: 1.5;"/><rect fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="217" x="240" y="523.9761"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="197" x="250" y="545.1147">add to global select expression</text><polygon fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" points="243.5,145.875,453.5,145.875,465.5,157.875,453.5,169.875,243.5,169.875,231.5,157.875,243.5,145.875" style="stroke: #383838; stroke-width: 1.5;"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="352.5" y="180.0854">yes</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="151" x="243.5" y="161.6831">unprocessed definitions in</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="49" x="398.5" y="161.6831">mapping</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="6" x="447.5" y="161.6831">?</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="217.5" y="155.2808">no</text><rect fill="#F8F8F8" filter="url(#f84g3wdr7kob4)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="215" x="241" y="599.9448"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="195" x="251" y="621.0835">return global select expression</text><ellipse cx="348.5" cy="664.9136" fill="#FFFFFF" filter="url(#f84g3wdr7kob4)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="348.5" cy="664.9136" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="348.5" x2="348.5" y1="30" y2="50"/><polygon fill="#383838" points="344.5,40,348.5,50,352.5,40,348.5,44" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="113.5" x2="90.5" y1="248.3901" y2="248.3901"/><line style="stroke: #383838; stroke-width: 1.5;" x1="90.5" x2="90.5" y1="248.3901" y2="271.1948"/><polygon fill="#383838" points="86.5,261.1948,90.5,271.1948,94.5,261.1948,90.5,265.1948" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="228.5" x2="251.5" y1="248.3901" y2="248.3901"/><line style="stroke: #383838; stroke-width: 1.5;" x1="251.5" x2="251.5" y1="248.3901" y2="271.1948"/><polygon fill="#383838" points="247.5,261.1948,251.5,271.1948,255.5,261.1948,251.5,265.1948" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="90.5" x2="90.5" y1="305.1636" y2="323.1636"/><line style="stroke: #383838; stroke-width: 1.5;" x1="90.5" x2="159" y1="323.1636" y2="323.1636"/><polygon fill="#383838" points="149,319.1636,159,323.1636,149,327.1636,153,323.1636" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="251.5" x2="251.5" y1="305.1636" y2="323.1636"/><line style="stroke: #383838; stroke-width: 1.5;" x1="251.5" x2="183" y1="323.1636" y2="323.1636"/><polygon fill="#383838" points="193,319.1636,183,323.1636,193,327.1636,189,323.1636" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="171" x2="171" y1="335.1636" y2="370.1636"/><polygon fill="#383838" points="167,360.1636,171,370.1636,175,360.1636,171,364.1636" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="171" x2="171" y1="404.1323" y2="439.1323"/><polygon fill="#383838" points="167,429.1323,171,439.1323,175,429.1323,171,433.1323" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="440.5" x2="440.5" y1="305.1636" y2="340.1636"/><polygon fill="#383838" points="436.5,330.1636,440.5,340.1636,444.5,330.1636,440.5,334.1636" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="611.5" x2="611.5" y1="305.1636" y2="340.1636"/><polygon fill="#383838" points="607.5,330.1636,611.5,340.1636,615.5,330.1636,611.5,334.1636" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="468.5" x2="440.5" y1="248.3901" y2="248.3901"/><line style="stroke: #383838; stroke-width: 1.5;" x1="440.5" x2="440.5" y1="248.3901" y2="271.1948"/><polygon fill="#383838" points="436.5,261.1948,440.5,271.1948,444.5,261.1948,440.5,265.1948" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="583.5" x2="611.5" y1="248.3901" y2="248.3901"/><line style="stroke: #383838; stroke-width: 1.5;" x1="611.5" x2="611.5" y1="248.3901" y2="271.1948"/><polygon fill="#383838" points="607.5,261.1948,611.5,271.1948,615.5,261.1948,611.5,265.1948" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="440.5" x2="440.5" y1="374.1323" y2="461.9761"/><line style="stroke: #383838; stroke-width: 1.5;" x1="440.5" x2="514" y1="461.9761" y2="461.9761"/><polygon fill="#383838" points="504,457.9761,514,461.9761,504,465.9761,508,461.9761" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="611.5" x2="611.5" y1="443.9761" y2="461.9761"/><line style="stroke: #383838; stroke-width: 1.5;" x1="611.5" x2="538" y1="461.9761" y2="461.9761"/><polygon fill="#383838" points="548,457.9761,538,461.9761,548,465.9761,544,461.9761" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="255.5" x2="171" y1="213.5854" y2="213.5854"/><line style="stroke: #383838; stroke-width: 1.5;" x1="171" x2="171" y1="213.5854" y2="235.5854"/><polygon fill="#383838" points="167,225.5854,171,235.5854,175,225.5854,171,229.5854" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="441.5" x2="526" y1="213.5854" y2="213.5854"/><line style="stroke: #383838; stroke-width: 1.5;" x1="526" x2="526" y1="213.5854" y2="235.5854"/><polygon fill="#383838" points="522,225.5854,526,235.5854,530,225.5854,526,229.5854" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="171" x2="171" y1="473.1011" y2="491.9761"/><line style="stroke: #383838; stroke-width: 1.5;" x1="171" x2="336.5" y1="491.9761" y2="491.9761"/><polygon fill="#383838" points="326.5,487.9761,336.5,491.9761,326.5,495.9761,330.5,491.9761" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="526" x2="526" y1="473.9761" y2="491.9761"/><line style="stroke: #383838; stroke-width: 1.5;" x1="526" x2="360.5" y1="491.9761" y2="491.9761"/><polygon fill="#383838" points="370.5,487.9761,360.5,491.9761,370.5,495.9761,366.5,491.9761" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="348.5" x2="348.5" y1="503.9761" y2="523.9761"/><polygon fill="#383838" points="344.5,513.9761,348.5,523.9761,352.5,513.9761,348.5,517.9761" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="348.5" x2="348.5" y1="169.875" y2="201.5854"/><polygon fill="#383838" points="344.5,191.5854,348.5,201.5854,352.5,191.5854,348.5,195.5854" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="348.5" x2="348.5" y1="557.9448" y2="567.9448"/><line style="stroke: #383838; stroke-width: 1.5;" x1="348.5" x2="716" y1="567.9448" y2="567.9448"/><polygon fill="#383838" points="712,378.8628,716,368.8628,720,378.8628,716,374.8628" style="stroke: #383838; stroke-width: 1.5;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="716" x2="716" y1="157.875" y2="567.9448"/><line style="stroke: #383838; stroke-width: 1.5;" x1="716" x2="465.5" y1="157.875" y2="157.875"/><polygon fill="#383838" points="475.5,153.875,465.5,157.875,475.5,161.875,471.5,157.875" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="231.5" x2="24" y1="157.875" y2="157.875"/><polygon fill="#383838" points="20,364.8628,24,374.8628,28,364.8628,24,368.8628" style="stroke: #383838; stroke-width: 1.5;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="24" x2="24" y1="157.875" y2="579.9448"/><line style="stroke: #383838; stroke-width: 1.5;" x1="24" x2="348.5" y1="579.9448" y2="579.9448"/><line style="stroke: #383838; stroke-width: 1.5;" x1="348.5" x2="348.5" y1="579.9448" y2="599.9448"/><polygon fill="#383838" points="344.5,589.9448,348.5,599.9448,352.5,589.9448,348.5,593.9448" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="348.5" x2="348.5" y1="125.875" y2="145.875"/><polygon fill="#383838" points="344.5,135.875,348.5,145.875,352.5,135.875,348.5,139.875" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="348.5" x2="348.5" y1="633.9136" y2="653.9136"/><polygon fill="#383838" points="344.5,643.9136,348.5,653.9136,352.5,643.9136,348.5,647.9136" style="stroke: #383838; stroke-width: 1.0;"/><!--MD5=[b3e02514750184507f8eb26717c36116]
@startuml
start

skinparam monochrome true
skinparam defaultFontname Bitstream Vera Sans Mono
' skinparam defaultFontSize 18

:**""mapping""**:
- **""source_column""**
- **""name""**
- **""data_type""**;
while (unprocessed definitions in **""mapping""**?) is (yes)
  if (**""data_type""** is Spark built-in?) then (yes)
    if (**""source_column""**\n is missing?) then (yes)
      :Value = **""None""**;
    else (no)
      :Value = **""source_column""**;
    endif
    :rename to **""name""**;
    :cast as **""data_type""**;
  else (no)
    if (**""source_column""**\n is missing?) then (yes)
      :Value = **""None""**;
      :rename to **""name""**;
    else (no)
      :Value = **""source_column""**;
      :_get_select_expression_↩
       ↪for_custom_type(
          **""source_column""**, 
          **""name""**, 
          **""data_type""**
      );
    endif
  endif
  :add to global select expression;
endwhile (no)
:return global select expression;

stop
@enduml

@startuml
start

skinparam monochrome true
skinparam defaultFontname Bitstream Vera Sans Mono

:**""mapping""**:
- **""source_column""**
- **""name""**
- **""data_type""**;
while (unprocessed definitions in **""mapping""**?) is (yes)
  if (**""data_type""** is Spark built-in?) then (yes)
    if (**""source_column""**\n is missing?) then (yes)
      :Value = **""None""**;
    else (no)
      :Value = **""source_column""**;
    endif
    :rename to **""name""**;
    :cast as **""data_type""**;
  else (no)
    if (**""source_column""**\n is missing?) then (yes)
      :Value = **""None""**;
      :rename to **""name""**;
    else (no)
      :Value = **""source_column""**;
      :_get_select_expression_↩
       ↪for_custom_type(
          **""source_column""**, 
          **""name""**, 
          **""data_type""**
      );
    endif
  endif
  :add to global select expression;
endwhile (no)
:return global select expression;

stop
@enduml

PlantUML version 1.2020.19(Mon Oct 12 17:10:01 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>