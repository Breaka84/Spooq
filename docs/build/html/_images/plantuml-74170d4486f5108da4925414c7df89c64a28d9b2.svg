<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="705px" preserveAspectRatio="none" style="width:950px;height:705px;" version="1.1" viewBox="0 0 950 705" width="950px" zoomAndPan="magnify"><defs><filter height="300%" id="f1im752i7i8plx" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[cbfbe30d7906789c5a6b3a4eb4c03b0d]
cluster extractor--><polygon fill="#FFFFFF" filter="url(#f1im752i7i8plx)" points="22,24,127,24,134,50.9531,928,50.9531,928,693,22,693,22,24" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="134" y1="50.9531" y2="50.9531"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="99" x="26" y="42.708">extractor</text><!--MD5=[45d5b4d0d0ef53375ad1c88c627ff544]
class extractor.Extractor--><rect fill="#F8F8F8" filter="url(#f1im752i7i8plx)" height="137.8125" id="extractor.Extractor" style="stroke: #383838; stroke-width: 1.5;" width="265" x="163.5" y="63"/><ellipse cx="242" cy="80" fill="#C2C2C2" rx="12" ry="12" style="stroke: #383838; stroke-width: 1.0;"/><path d="M245,86.125 Q244.3906,86.4375 243.7031,86.5938 Q243.0313,86.75 242.2813,86.75 Q239.625,86.75 238.2344,85 Q236.8438,83.25 236.8438,79.9531 Q236.8438,76.6406 238.2344,74.8906 Q239.625,73.1406 242.2813,73.1406 Q243.0313,73.1406 243.7188,73.2969 Q244.4063,73.4531 245,73.7656 L245,76.6563 Q244.3281,76.0469 243.7031,75.7656 Q243.0781,75.4688 242.4063,75.4688 Q240.9844,75.4688 240.25,76.6094 Q239.5313,77.7344 239.5313,79.9531 Q239.5313,82.1719 240.25,83.2969 Q240.9844,84.4219 242.4063,84.4219 Q243.0781,84.4219 243.7031,84.1406 Q244.3281,83.8594 245,83.2344 L245,86.125 Z "/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="99" x="264" y="86.2314">Extractor</text><line style="stroke: #383838; stroke-width: 1.5;" x1="164.5" x2="427.5" y1="97" y2="97"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="110" x="169.5" y="142.6611">name : str</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="253" x="169.5" y="163.6143">logger : logging.logger</text><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="164.5" x2="257.5" y1="115.4766" y2="115.4766"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="77" x="257.5" y="121.208">derived</text><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="334.5" x2="427.5" y1="115.4766" y2="115.4766"/><line style="stroke: #383838; stroke-width: 1.5;" x1="164.5" x2="427.5" y1="171.8594" y2="171.8594"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="99" x="169.5" y="192.5674">extract()</text><!--MD5=[a804dd878b9ad2513b5909bc42a11ccb]
class extractor.JSONExtractor--><rect fill="#F8F8F8" filter="url(#f1im752i7i8plx)" height="179.7188" id="extractor.JSONExtractor" style="stroke: #383838; stroke-width: 1.5;" width="232" x="109" y="261"/><ellipse cx="149.75" cy="278" fill="#C2C2C2" rx="12" ry="12" style="stroke: #383838; stroke-width: 1.0;"/><path d="M152.75,284.125 Q152.1406,284.4375 151.4531,284.5938 Q150.7813,284.75 150.0313,284.75 Q147.375,284.75 145.9844,283 Q144.5938,281.25 144.5938,277.9531 Q144.5938,274.6406 145.9844,272.8906 Q147.375,271.1406 150.0313,271.1406 Q150.7813,271.1406 151.4688,271.2969 Q152.1563,271.4531 152.75,271.7656 L152.75,274.6563 Q152.0781,274.0469 151.4531,273.7656 Q150.8281,273.4688 150.1563,273.4688 Q148.7344,273.4688 148,274.6094 Q147.2813,275.7344 147.2813,277.9531 Q147.2813,280.1719 148,281.2969 Q148.7344,282.4219 150.1563,282.4219 Q150.8281,282.4219 151.4531,282.1406 Q152.0781,281.8594 152.75,281.2344 L152.75,284.125 Z "/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="143" x="170.25" y="284.2314">JSONExtractor</text><line style="stroke: #383838; stroke-width: 1.5;" x1="110" x2="340" y1="295" y2="295"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="176" x="115" y="315.708">input_path : str</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="165" x="115" y="336.6611">base_path : str</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="165" x="115" y="357.6143">partition : str</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="220" x="115" y="403.5205">spark : SparkSession</text><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="110" x2="186.5" y1="376.3359" y2="376.3359"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="77" x="186.5" y="382.0674">derived</text><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="263.5" x2="340" y1="376.3359" y2="376.3359"/><line style="stroke: #383838; stroke-width: 1.5;" x1="110" x2="340" y1="411.7656" y2="411.7656"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="99" x="115" y="432.4736">extract()</text><!--MD5=[53e82bf17bad6aaa1ae057ceff09bc1f]
class extractor.JDBCExtractor--><rect fill="#F8F8F8" filter="url(#f1im752i7i8plx)" height="158.7656" id="extractor.JDBCExtractor" style="stroke: #383838; stroke-width: 1.5;" width="232" x="376" y="271.5"/><ellipse cx="416.75" cy="288.5" fill="#C2C2C2" rx="12" ry="12" style="stroke: #383838; stroke-width: 1.0;"/><path d="M419.75,294.625 Q419.1406,294.9375 418.4531,295.0938 Q417.7813,295.25 417.0313,295.25 Q414.375,295.25 412.9844,293.5 Q411.5938,291.75 411.5938,288.4531 Q411.5938,285.1406 412.9844,283.3906 Q414.375,281.6406 417.0313,281.6406 Q417.7813,281.6406 418.4688,281.7969 Q419.1563,281.9531 419.75,282.2656 L419.75,285.1563 Q419.0781,284.5469 418.4531,284.2656 Q417.8281,283.9688 417.1563,283.9688 Q415.7344,283.9688 415,285.1094 Q414.2813,286.2344 414.2813,288.4531 Q414.2813,290.6719 415,291.7969 Q415.7344,292.9219 417.1563,292.9219 Q417.8281,292.9219 418.4531,292.6406 Q419.0781,292.3594 419.75,291.7344 L419.75,294.625 Z "/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="143" x="437.25" y="294.7314">JDBCExtractor</text><line style="stroke: #383838; stroke-width: 1.5;" x1="377" x2="607" y1="305.5" y2="305.5"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="209" x="382" y="326.208">jdbc_options : dict</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="209" x="382" y="347.1611">cache : bool = True</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="220" x="382" y="393.0674">spark : SparkSession</text><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="377" x2="453.5" y1="365.8828" y2="365.8828"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="77" x="453.5" y="371.6143">derived</text><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="530.5" x2="607" y1="365.8828" y2="365.8828"/><line style="stroke: #383838; stroke-width: 1.5;" x1="377" x2="607" y1="401.3125" y2="401.3125"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="99" x="382" y="422.0205">extract()</text><!--MD5=[40520d462a206087eff617234312a248]
class extractor.JDBCExtractorFullLoad--><rect fill="#F8F8F8" filter="url(#f1im752i7i8plx)" height="91.9063" id="extractor.JDBCExtractorFullLoad" style="stroke: #383838; stroke-width: 1.5;" width="265" x="38.5" y="543"/><ellipse cx="54.5" cy="560" fill="#C2C2C2" rx="12" ry="12" style="stroke: #383838; stroke-width: 1.0;"/><path d="M57.5,566.125 Q56.8906,566.4375 56.2031,566.5938 Q55.5313,566.75 54.7813,566.75 Q52.125,566.75 50.7344,565 Q49.3438,563.25 49.3438,559.9531 Q49.3438,556.6406 50.7344,554.8906 Q52.125,553.1406 54.7813,553.1406 Q55.5313,553.1406 56.2188,553.2969 Q56.9063,553.4531 57.5,553.7656 L57.5,556.6563 Q56.8281,556.0469 56.2031,555.7656 Q55.5781,555.4688 54.9063,555.4688 Q53.4844,555.4688 52.75,556.6094 Q52.0313,557.7344 52.0313,559.9531 Q52.0313,562.1719 52.75,563.2969 Q53.4844,564.4219 54.9063,564.4219 Q55.5781,564.4219 56.2031,564.1406 Q56.8281,563.8594 57.5,563.2344 L57.5,566.125 Z "/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="231" x="69.5" y="566.2314">JDBCExtractorFullLoad</text><line style="stroke: #383838; stroke-width: 1.5;" x1="39.5" x2="302.5" y1="577" y2="577"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="121" x="44.5" y="597.708">query : str</text><line style="stroke: #383838; stroke-width: 1.5;" x1="39.5" x2="302.5" y1="605.9531" y2="605.9531"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="99" x="44.5" y="626.6611">extract()</text><!--MD5=[573ef1b0847587e468a3420ac5c434b6]
class extractor.JDBCExtractorIncremental--><rect fill="#F8F8F8" filter="url(#f1im752i7i8plx)" height="175.7188" id="extractor.JDBCExtractorIncremental" style="stroke: #383838; stroke-width: 1.5;" width="573" x="338.5" y="501"/><ellipse cx="488.5" cy="518" fill="#C2C2C2" rx="12" ry="12" style="stroke: #383838; stroke-width: 1.0;"/><path d="M491.5,524.125 Q490.8906,524.4375 490.2031,524.5938 Q489.5313,524.75 488.7813,524.75 Q486.125,524.75 484.7344,523 Q483.3438,521.25 483.3438,517.9531 Q483.3438,514.6406 484.7344,512.8906 Q486.125,511.1406 488.7813,511.1406 Q489.5313,511.1406 490.2188,511.2969 Q490.9063,511.4531 491.5,511.7656 L491.5,514.6563 Q490.8281,514.0469 490.2031,513.7656 Q489.5781,513.4688 488.9063,513.4688 Q487.4844,513.4688 486.75,514.6094 Q486.0313,515.7344 486.0313,517.9531 Q486.0313,520.1719 486.75,521.2969 Q487.4844,522.4219 488.9063,522.4219 Q489.5781,522.4219 490.2031,522.1406 Q490.8281,521.8594 491.5,521.2344 L491.5,524.125 Z "/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="264" x="510.5" y="524.2314">JDBCExtractorIncremental</text><line style="stroke: #383838; stroke-width: 1.5;" x1="339.5" x2="910.5" y1="535" y2="535"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="165" x="344.5" y="555.708">partition : str</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="198" x="344.5" y="576.6611">source_table : str</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="275" x="344.5" y="597.6143">spooq2_values_table : str</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="440" x="344.5" y="618.5674">spooq2_values_db : str = "spooq2_values"</text><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="561" x="344.5" y="639.5205">spooq2_values_partition_column : str = "updated_at"</text><line style="stroke: #383838; stroke-width: 1.5;" x1="339.5" x2="910.5" y1="647.7656" y2="647.7656"/><text fill="#000000" font-family="Bitstream Vera Sans Mono" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="99" x="344.5" y="668.4736">extract()</text><!--MD5=[ff155a5dfe0d342a67724a6b3d499fde]
reverse link extractor.Extractor to extractor.JSONExtractor--><path d="M267.48,220.18 C263.11,233.51 258.6,247.29 254.23,260.67 " fill="none" id="extractor.Extractor&lt;-extractor.JSONExtractor" style="stroke: #383838; stroke-width: 1.0;"/><polygon fill="none" points="260.86,217.9,273.73,201.06,274.16,222.25,260.86,217.9" style="stroke: #383838; stroke-width: 1.0;"/><!--MD5=[78b0bfbb80eea96e2939411f4c9b8970]
reverse link extractor.Extractor to extractor.JDBCExtractor--><path d="M370.97,216 C387.33,234.11 404.6,253.23 420.81,271.18 " fill="none" id="extractor.Extractor&lt;-extractor.JDBCExtractor" style="stroke: #383838; stroke-width: 1.0;"/><polygon fill="none" points="365.69,220.6,357.48,201.06,376.08,211.21,365.69,220.6" style="stroke: #383838; stroke-width: 1.0;"/><!--MD5=[ab15c728de0092aea3a8e8e09a5720a9]
reverse link extractor.JDBCExtractor to extractor.JDBCExtractorFullLoad--><path d="M368.83,442.56 C322.19,476.85 271.1,514.41 232.52,542.77 " fill="none" id="extractor.JDBCExtractor&lt;-extractor.JDBCExtractorFullLoad" style="stroke: #383838; stroke-width: 1.0;"/><polygon fill="none" points="364.85,436.79,385.11,430.58,373.14,448.07,364.85,436.79" style="stroke: #383838; stroke-width: 1.0;"/><!--MD5=[80db63361c683799a8fdbb8e02072de8]
reverse link extractor.JDBCExtractor to extractor.JDBCExtractorIncremental--><path d="M546.16,448.1 C555.99,465.54 566.19,483.65 575.87,500.81 " fill="none" id="extractor.JDBCExtractor&lt;-extractor.JDBCExtractorIncremental" style="stroke: #383838; stroke-width: 1.0;"/><polygon fill="none" points="540.01,451.44,536.29,430.58,552.2,444.57,540.01,451.44" style="stroke: #383838; stroke-width: 1.0;"/><!--MD5=[f182033c211e623da2ec5b81c3b0b598]
@startuml

skinparam monochrome true
skinparam defaultFontname Bitstream Vera Sans Mono
skinparam defaultFontSize 18



  namespace extractor {
      
      class Extractor {
        .. derived ..
        name : str
        logger : logging.logger
        __
        extract()
      }
      Extractor <|- - JSONExtractor
      class JSONExtractor{
        input_path : str
        base_path : str
        partition : str
        .. derived ..
        spark : SparkSession
        __
        extract()
      }
      Extractor <|- - JDBCExtractor
      class JDBCExtractor{
        jdbc_options : dict
        cache : bool = True
        .. derived ..
        spark : SparkSession
        __
        extract()
      }
      JDBCExtractor <|- - JDBCExtractorFullLoad
      class JDBCExtractorFullLoad {
        query : str
        __
        extract()
      }
      JDBCExtractor <|- - JDBCExtractorIncremental
      class JDBCExtractorIncremental {
        partition : str 
        source_table : str 
        spooq2_values_table : str 
        spooq2_values_db : str = "spooq2_values"
        spooq2_values_partition_column : str = "updated_at"
        __
        extract()
      }

  }
 @enduml

PlantUML version 1.2020.07(Sun Apr 19 13:42:40 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_242-b08
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>