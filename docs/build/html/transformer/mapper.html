

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Mapper &mdash; Spooq2 2.0.0b0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Threshold-based Cleaner" href="threshold_cleaner.html" />
    <link rel="prev" title="Sieve (Filter)" href="sieve.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Spooq2
          

          
          </a>

          
            
            
              <div class="version">
                2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation / Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extractor/overview.html">Extractors</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="overview.html">Transformers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="exploder.html">Exploder</a></li>
<li class="toctree-l2"><a class="reference internal" href="sieve.html">Sieve (Filter)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Mapper</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-spooq2.transformer.mapper">Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#activity-diagram">Activity Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-spooq2.transformer.mapper_custom_data_types">Custom Mapping Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="threshold_cleaner.html">Threshold-based Cleaner</a></li>
<li class="toctree-l2"><a class="reference internal" href="newest_by_group.html">Newest by Group (Most current record per ID)</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#class-diagram-of-transformer-subpackage">Class Diagram of Transformer Subpackage</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#create-your-own-transformer">Create your own Transformer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../loader/overview.html">Loaders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pipeline/overview.html">Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../base_classes/overview.html">Spooq Base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup_development_testing.html">Setup for Development, Testing, Documenting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architecture Overview</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Spooq2</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="overview.html">Transformers</a> &raquo;</li>
        
      <li>Mapper</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/transformer/mapper.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mapper">
<h1>Mapper<a class="headerlink" href="#mapper" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-spooq2.transformer.mapper">
<span id="class"></span><h2>Class<a class="headerlink" href="#module-spooq2.transformer.mapper" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="spooq2.transformer.mapper.Mapper">
<em class="property">class </em><code class="descname">Mapper</code><span class="sig-paren">(</span><em>mapping</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper.html#Mapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper.Mapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../base_classes/transformer.html#spooq2.transformer.transformer.Transformer" title="spooq2.transformer.transformer.Transformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">spooq2.transformer.transformer.Transformer</span></code></a></p>
<p>Constructs and applies a PySpark SQL expression, based on the provided mapping.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span>              <span class="s1">&#39;data.relationships.food.data.id&#39;</span><span class="p">,</span>     <span class="s1">&#39;StringType&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;message_id&#39;</span><span class="p">,</span>      <span class="s1">&#39;data.id&#39;</span><span class="p">,</span>                             <span class="s1">&#39;StringType&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span>            <span class="s1">&#39;data.relationships.food.data.type&#39;</span><span class="p">,</span>   <span class="s1">&#39;StringType&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;created_at&#39;</span><span class="p">,</span>      <span class="s1">&#39;elem.attributes.created_at&#39;</span><span class="p">,</span>          <span class="s1">&#39;timestamp_ms_to_s&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;updated_at&#39;</span><span class="p">,</span>      <span class="s1">&#39;elem.attributes.updated_at&#39;</span><span class="p">,</span>          <span class="s1">&#39;timestamp_ms_to_s&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;deleted_at&#39;</span><span class="p">,</span>      <span class="s1">&#39;elem.attributes.deleted_at&#39;</span><span class="p">,</span>          <span class="s1">&#39;timestamp_ms_to_s&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;brand&#39;</span><span class="p">,</span>           <span class="s1">&#39;elem.attributes.brand&#39;</span><span class="p">,</span>               <span class="s1">&#39;StringType&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transformer</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">mapping</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span>          <span class="s1">&#39;data.relationships.food.data.id&#39;</span><span class="p">,</span>   <span class="s1">&#39;StringType&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;updated_at&#39;</span><span class="p">,</span>  <span class="s1">&#39;elem.attributes.updated_at&#39;</span><span class="p">,</span>        <span class="s1">&#39;timestamp_ms_to_s&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;deleted_at&#39;</span><span class="p">,</span>  <span class="s1">&#39;elem.attributes.deleted_at&#39;</span><span class="p">,</span>        <span class="s1">&#39;timestamp_ms_to_s&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span>        <span class="s1">&#39;elem.attributes.name&#39;</span><span class="p">,</span>              <span class="s1">&#39;array&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transformer</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">mapping</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mapping</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#list" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#tuple" title="(in Python v3.7)"><code class="xref any docutils literal notranslate"><span class="pre">tuple</span></code></a> containing three <a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref any docutils literal notranslate"><span class="pre">str</span></code></a>) – This is the main parameter for this transformation. It essentially gives information
about the column names for the output DataFrame, the column names (paths)
from the input DataFrame, and their data types. Custom data types are also supported, which can
clean, pivot, anonymize, … the data itself. Please have a look at the
<a class="reference internal" href="#module-spooq2.transformer.mapper_custom_data_types" title="spooq2.transformer.mapper_custom_data_types"><code class="xref py py-mod docutils literal notranslate"><span class="pre">spooq2.transformer.mapper_custom_data_types</span></code></a> module for more information.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Let’s talk about Mappings:</p>
<p>The mapping should be a list of tuples which are containing all information per column.</p>
<ul class="last">
<li><dl class="first docutils">
<dt>Column Name <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref any docutils literal notranslate"><span class="pre">str</span></code></a></span></dt>
<dd><p class="first last">Sets the name of the column in the resulting output DataFrame.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Source Path / Name <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref any docutils literal notranslate"><span class="pre">str</span></code></a></span></dt>
<dd><p class="first last">Points to the name of the column in the input DataFrame. If the input
is a flat DataFrame, it will essentially be the column name. If it is of complex
type, it will point to the path of the actual value. For example:
<code class="docutils literal notranslate"><span class="pre">data.relationships.sample.data.id</span></code>, where id is the value we want.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>DataType <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref any docutils literal notranslate"><span class="pre">str</span></code></a></span></dt>
<dd><p class="first last">DataTypes can be types from <a class="reference external" href="https://spark.apache.org/docs/2.4.3/api/python/pyspark.sql.html#module-pyspark.sql.types" title="(in PySpark vmaster)"><code class="xref any docutils literal notranslate"><span class="pre">pyspark.sql.types</span></code></a>, selected custom datatypes or
injected, ad-hoc custom datatypes.
The datatype will be interpreted as a PySpark built-in if it is a member of <code class="docutils literal notranslate"><span class="pre">pyspark.sql.types</span></code>.
If it is not an importable PySpark data type, a method to construct the statement will be
called by the data type’s name.</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please see <a class="reference internal" href="#module-spooq2.transformer.mapper_custom_data_types" title="spooq2.transformer.mapper_custom_data_types"><code class="xref py py-mod docutils literal notranslate"><span class="pre">spooq2.transformer.mapper_custom_data_types</span></code></a> for all available custom
data types and how to inject your own.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Attention: Decimal is NOT SUPPORTED by Hive! Please use Double instead!</p>
</div>
<dl class="method">
<dt id="spooq2.transformer.mapper.Mapper.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>input_df</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper.html#Mapper.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper.Mapper.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a transformation on a DataFrame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>input_df</strong> (<a class="reference external" href="https://spark.apache.org/docs/2.4.3/api/python/pyspark.sql.html#pyspark.sql.DataFrame" title="(in PySpark vmaster)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyspark.sql.DataFrame</span></code></a>) – Input DataFrame</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Transformed DataFrame.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://spark.apache.org/docs/2.4.3/api/python/pyspark.sql.html#pyspark.sql.DataFrame" title="(in PySpark vmaster)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyspark.sql.DataFrame</span></code></a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method does only take the Input DataFrame as a parameters. All other needed parameters
are defined in the initialization of the Transformator Object.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="activity-diagram">
<h2>Activity Diagram<a class="headerlink" href="#activity-diagram" title="Permalink to this headline">¶</a></h2>
<p class="plantuml">
<img src="../_images/plantuml-95d88ab79bc74cc16a47d960c784615eb24258cf.svg" alt="&#64;startuml
start

skinparam monochrome true
skinparam defaultFontname Bitstream Vera Sans Mono
' skinparam defaultFontSize 18

:**&quot;&quot;mapping&quot;&quot;**:
- **&quot;&quot;source_column&quot;&quot;**
- **&quot;&quot;name&quot;&quot;**
- **&quot;&quot;data_type&quot;&quot;**;
while (unprocessed definitions in **&quot;&quot;mapping&quot;&quot;**?) is (yes)
  if (**&quot;&quot;data_type&quot;&quot;** is Spark built-in?) then (yes)
    if (**&quot;&quot;source_column&quot;&quot;**\n is missing?) then (yes)
      :Value = **&quot;&quot;None&quot;&quot;**;
    else (no)
      :Value = **&quot;&quot;source_column&quot;&quot;**;
    endif
    :rename to **&quot;&quot;name&quot;&quot;**;
    :cast as **&quot;&quot;data_type&quot;&quot;**;
  else (no)
    if (**&quot;&quot;source_column&quot;&quot;**\n is missing?) then (yes)
      :Value = **&quot;&quot;None&quot;&quot;**;
      :rename to **&quot;&quot;name&quot;&quot;**;
    else (no)
      :Value = **&quot;&quot;source_column&quot;&quot;**;
      :_get_select_expression_↩
       ↪for_custom_type(
          **&quot;&quot;source_column&quot;&quot;**, 
          **&quot;&quot;name&quot;&quot;**, 
          **&quot;&quot;data_type&quot;&quot;**
      );
    endif
  endif
  :add to global select expression;
endwhile (no)
:return global select expression;

stop
&#64;enduml
"/></p>
</div>
<div class="section" id="module-spooq2.transformer.mapper_custom_data_types">
<span id="custom-mapping-methods"></span><h2>Custom Mapping Methods<a class="headerlink" href="#module-spooq2.transformer.mapper_custom_data_types" title="Permalink to this headline">¶</a></h2>
<p>This is a collection of module level methods to construct a specific
PySpark DataFrame query for custom defined data types.</p>
<p>These methods are not meant to be called directly but via the
the <a class="reference internal" href="#spooq2.transformer.mapper.Mapper" title="spooq2.transformer.mapper.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> transformer.
Please see that particular class on how to apply custom data types.</p>
<p>For injecting your <strong>own custom data types</strong>, please have a visit to the
<a class="reference internal" href="#spooq2.transformer.mapper_custom_data_types.add_custom_data_type" title="spooq2.transformer.mapper_custom_data_types.add_custom_data_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_custom_data_type()</span></code></a> method!</p>
<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types.add_custom_data_type">
<code class="descname">add_custom_data_type</code><span class="sig-paren">(</span><em>function_name</em>, <em>func</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#add_custom_data_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types.add_custom_data_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers a custom data type in runtime to be used with the <a class="reference internal" href="#spooq2.transformer.mapper.Mapper" title="spooq2.transformer.mapper.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> transformer.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spooq2.transformer.mapper_custom_data_types</span> <span class="k">as</span> <span class="nn">custom_types</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spooq2.transformer</span> <span class="k">as</span> <span class="nn">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span><span class="p">,</span> <span class="n">functions</span> <span class="k">as</span> <span class="n">F</span><span class="p">,</span> <span class="n">types</span> <span class="k">as</span> <span class="n">sql_types</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">hello_world</span><span class="p">(</span><span class="n">source_column</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;A UDF (User Defined Function) in Python&quot;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">_to_hello_world</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="k">return</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="k">return</span> <span class="s2">&quot;Hello World&quot;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">udf_hello_world</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">udf</span><span class="p">(</span><span class="n">_to_hello_world</span><span class="p">,</span> <span class="n">sql_types</span><span class="o">.</span><span class="n">StringType</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">udf_hello_world</span><span class="p">(</span><span class="n">source_column</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="n">Row</span><span class="p">(</span><span class="n">hello_from</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;tsivorn1@who.int&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">Row</span><span class="p">(</span><span class="n">hello_from</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">Row</span><span class="p">(</span><span class="n">hello_from</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;gisaksen4@skype.com&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_types</span><span class="o">.</span><span class="n">add_custom_data_type</span><span class="p">(</span><span class="n">function_name</span><span class="o">=</span><span class="s2">&quot;hello_world&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">hello_world</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transformer</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;hello_who&quot;</span><span class="p">,</span> <span class="s2">&quot;hello_from&quot;</span><span class="p">,</span> <span class="s2">&quot;hello_world&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+-----------+</span>
<span class="go">|  hello_who|</span>
<span class="go">+-----------+</span>
<span class="go">|Hello World|</span>
<span class="go">|       null|</span>
<span class="go">|Hello World|</span>
<span class="go">+-----------+</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">first_and_last_name</span><span class="p">(</span><span class="n">source_column</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;A PySpark SQL expression referencing multiple columns&quot;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">concat_ws</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="n">source_column</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;attributes.last_name&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_types</span><span class="o">.</span><span class="n">add_custom_data_type</span><span class="p">(</span><span class="n">function_name</span><span class="o">=</span><span class="s2">&quot;full_name&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">first_and_last_name</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transformer</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">,</span> <span class="s2">&quot;attributes.first_name&quot;</span><span class="p">,</span> <span class="s2">&quot;StringType&quot;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s2">&quot;last_name&quot;</span><span class="p">,</span>  <span class="s2">&quot;attributes.last_name&quot;</span><span class="p">,</span>  <span class="s2">&quot;StringType&quot;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s2">&quot;full_name&quot;</span><span class="p">,</span>  <span class="s2">&quot;attributes.first_name&quot;</span><span class="p">,</span> <span class="s2">&quot;full_name&quot;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_name</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref any docutils literal notranslate"><span class="pre">str</span></code></a>) – The name of your custom data type</li>
<li><strong>func</strong> (<em>compatible function</em>) – The PySpark dataframe function which will be called on a column, defined in the mapping
of the Mapper class.
Required input parameters are <code class="docutils literal notranslate"><span class="pre">source_column</span></code> and <code class="docutils literal notranslate"><span class="pre">name</span></code>.
Please see the note about required input parameter of custom data types for more information!</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Required input parameter of custom data types:</p>
<dl class="last docutils">
<dt><strong>source_column</strong> (<a class="reference external" href="https://spark.apache.org/docs/2.4.3/api/python/pyspark.sql.html#pyspark.sql.Column" title="(in PySpark vmaster)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyspark.sql.Column</span></code></a>) - This is where your logic will be applied.</dt>
<dd>The mapper transformer takes care of calling this method with the right column so you can just
handle it like an object which you would get from <code class="docutils literal notranslate"><span class="pre">df[&quot;some_attribute&quot;]</span></code>.</dd>
<dt><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref any docutils literal notranslate"><span class="pre">str</span></code></a>) - The name how the resulting column will be named. Nested attributes are not</dt>
<dd>supported. The Mapper transformer takes care of calling this method with the right column name.</dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._get_select_expression_for_custom_type">
<code class="descname">_get_select_expression_for_custom_type</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em>, <em>data_type</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_get_select_expression_for_custom_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._get_select_expression_for_custom_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal method for calling functions dynamically</p>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_as_is">
<code class="descname">_generate_select_expression_for_as_is</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_generate_select_expression_for_as_is"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_as_is" title="Permalink to this definition">¶</a></dt>
<dd><p>alias for <cite>_generate_select_expression_without_casting</cite></p>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_keep">
<code class="descname">_generate_select_expression_for_keep</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_generate_select_expression_for_keep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_keep" title="Permalink to this definition">¶</a></dt>
<dd><p>alias for <cite>_generate_select_expression_without_casting</cite></p>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_no_change">
<code class="descname">_generate_select_expression_for_no_change</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_generate_select_expression_for_no_change"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_no_change" title="Permalink to this definition">¶</a></dt>
<dd><p>alias for <cite>_generate_select_expression_without_casting</cite></p>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._generate_select_expression_without_casting">
<code class="descname">_generate_select_expression_without_casting</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_generate_select_expression_without_casting"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._generate_select_expression_without_casting" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a column without casting. This is especially useful if you need to
keep a complex data type, like an array, list or a struct.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spooq2.transformer</span> <span class="kn">import</span> <span class="n">Mapper</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Row(friends=[Row(first_name=None, id=3993, last_name=None), Row(first_name=u&#39;Ruò&#39;, id=17484, last_name=u&#39;Trank&#39;)]),</span>
<span class="go"> Row(friends=[]),</span>
<span class="go"> Row(friends=[Row(first_name=u&#39;Daphnée&#39;, id=16707, last_name=u&#39;Lyddiard&#39;), Row(first_name=u&#39;Adélaïde&#39;, id=17429, last_name=u&#39;Wisdom&#39;)])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;my_friends&quot;</span><span class="p">,</span> <span class="s2">&quot;friends&quot;</span><span class="p">,</span> <span class="s2">&quot;as_is&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Row(my_friends=[Row(first_name=None, id=3993, last_name=None), Row(first_name=u&#39;Ruò&#39;, id=17484, last_name=u&#39;Trank&#39;)]),</span>
<span class="go"> Row(my_friends=[]),</span>
<span class="go"> Row(my_friends=[Row(first_name=u&#39;Daphnée&#39;, id=16707, last_name=u&#39;Lyddiard&#39;), Row(first_name=u&#39;Adélaïde&#39;, id=17429, last_name=u&#39;Wisdom&#39;)])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_json_string">
<code class="descname">_generate_select_expression_for_json_string</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_generate_select_expression_for_json_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_json_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a column as json compatible string.
Nested hierarchies are supported.
The unicode representation of a column will be returned if an error occurs.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spooq2.transformer</span> <span class="kn">import</span> <span class="n">Mapper</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Row(friends=[Row(first_name=None, id=3993, last_name=None), Row(first_name=u&#39;Ruò&#39;, id=17484, last_name=u&#39;Trank&#39;)]),</span>
<span class="go"> Row(friends=[]),</span>
<span class="go"> Row(friends=[Row(first_name=u&#39;Daphnée&#39;, id=16707, last_name=u&#39;Lyddiard&#39;), Row(first_name=u&#39;Adélaïde&#39;, id=17429, last_name=u&#39;Wisdom&#39;)])]    &gt;&gt;&gt; mapping = [(&quot;friends_json&quot;, &quot;friends&quot;, &quot;json_string&quot;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;friends_json&quot;</span><span class="p">,</span> <span class="s2">&quot;friends&quot;</span><span class="p">,</span> <span class="s2">&quot;json_string&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Row(friends_json=u&#39;[{&quot;first_name&quot;: null, &quot;last_name&quot;: null, &quot;id&quot;: 3993}, {&quot;first_name&quot;: &quot;Ru\u00f2&quot;, &quot;last_name&quot;: &quot;Trank&quot;, &quot;id&quot;: 17484}]&#39;),</span>
<span class="go"> Row(friends_json=None),</span>
<span class="go"> Row(friends_json=u&#39;[{&quot;first_name&quot;: &quot;Daphn\u00e9e&quot;, &quot;last_name&quot;: &quot;Lyddiard&quot;, &quot;id&quot;: 16707}, {&quot;first_name&quot;: &quot;Ad\u00e9la\u00efde&quot;, &quot;last_name&quot;: &quot;Wisdom&quot;, &quot;id&quot;: 17429}]&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_timestamp_ms_to_ms">
<code class="descname">_generate_select_expression_for_timestamp_ms_to_ms</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_generate_select_expression_for_timestamp_ms_to_ms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_timestamp_ms_to_ms" title="Permalink to this definition">¶</a></dt>
<dd><p>This Constructor is used for unix timestamps. The values are cleaned
next to casting and renaming.
If the values are not between <cite>01.01.1970</cite> and <cite>31.12.2099</cite>,
NULL will be returned.
Cast to <a class="reference external" href="https://spark.apache.org/docs/2.4.3/api/python/pyspark.sql.html#pyspark.sql.types.LongType" title="(in PySpark vmaster)"><code class="xref any docutils literal notranslate"><span class="pre">pyspark.sql.types.LongType</span></code></a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spooq2.transformer</span> <span class="kn">import</span> <span class="n">Mapper</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Row</span><span class="p">(</span><span class="n">time_sec</span><span class="o">=</span><span class="mi">1581540839000</span><span class="p">),</span>  <span class="c1"># 02/12/2020 @ 8:53pm (UTC)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Row</span><span class="p">(</span><span class="n">time_sec</span><span class="o">=-</span><span class="mi">4887839000</span><span class="p">),</span>    <span class="c1"># Invalid!</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Row</span><span class="p">(</span><span class="n">time_sec</span><span class="o">=</span><span class="mi">4737139200000</span><span class="p">)</span>   <span class="c1"># 02/12/2120 @ 12:00am (UTC)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;unix_ts&quot;</span><span class="p">,</span> <span class="s2">&quot;time_sec&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp_ms_to_ms&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Row(unix_ts=1581540839000), Row(unix_ts=None), Row(unix_ts=None)]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><em>input</em>  in <strong>milli seconds</strong>
<em>output</em> in <strong>milli seconds</strong></p>
</div>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_timestamp_ms_to_s">
<code class="descname">_generate_select_expression_for_timestamp_ms_to_s</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_generate_select_expression_for_timestamp_ms_to_s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_timestamp_ms_to_s" title="Permalink to this definition">¶</a></dt>
<dd><p>This Constructor is used for unix timestamps. The values are cleaned
next to casting and renaming.
If the values are not between <cite>01.01.1970</cite> and <cite>31.12.2099</cite>,
NULL will be returned.
Cast to <a class="reference external" href="https://spark.apache.org/docs/2.4.3/api/python/pyspark.sql.html#pyspark.sql.types.LongType" title="(in PySpark vmaster)"><code class="xref any docutils literal notranslate"><span class="pre">pyspark.sql.types.LongType</span></code></a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spooq2.transformer</span> <span class="kn">import</span> <span class="n">Mapper</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Row</span><span class="p">(</span><span class="n">time_sec</span><span class="o">=</span><span class="mi">1581540839000</span><span class="p">),</span>  <span class="c1"># 02/12/2020 @ 8:53pm (UTC)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Row</span><span class="p">(</span><span class="n">time_sec</span><span class="o">=-</span><span class="mi">4887839000</span><span class="p">),</span>    <span class="c1"># Invalid!</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Row</span><span class="p">(</span><span class="n">time_sec</span><span class="o">=</span><span class="mi">4737139200000</span><span class="p">)</span>   <span class="c1"># 02/12/2120 @ 12:00am (UTC)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;unix_ts&quot;</span><span class="p">,</span> <span class="s2">&quot;time_sec&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp_ms_to_s&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Row(unix_ts=1581540839), Row(unix_ts=None), Row(unix_ts=None)]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><em>input</em>  in <strong>milli seconds</strong>
<em>output</em> in <strong>seconds</strong></p>
</div>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_timestamp_s_to_ms">
<code class="descname">_generate_select_expression_for_timestamp_s_to_ms</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_generate_select_expression_for_timestamp_s_to_ms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_timestamp_s_to_ms" title="Permalink to this definition">¶</a></dt>
<dd><p>This Constructor is used for unix timestamps. The values are cleaned
next to casting and renaming.
If the values are not between <cite>01.01.1970</cite> and <cite>31.12.2099</cite>,
NULL will be returned.
Cast to <a class="reference external" href="https://spark.apache.org/docs/2.4.3/api/python/pyspark.sql.html#pyspark.sql.types.LongType" title="(in PySpark vmaster)"><code class="xref any docutils literal notranslate"><span class="pre">pyspark.sql.types.LongType</span></code></a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spooq2.transformer</span> <span class="kn">import</span> <span class="n">Mapper</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Row</span><span class="p">(</span><span class="n">time_sec</span><span class="o">=</span><span class="mi">1581540839</span><span class="p">),</span>  <span class="c1"># 02/12/2020 @ 8:53pm (UTC)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Row</span><span class="p">(</span><span class="n">time_sec</span><span class="o">=-</span><span class="mi">4887839</span><span class="p">),</span>    <span class="c1"># Invalid!</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Row</span><span class="p">(</span><span class="n">time_sec</span><span class="o">=</span><span class="mi">4737139200</span><span class="p">)</span>   <span class="c1"># 02/12/2120 @ 12:00am (UTC)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;unix_ts&quot;</span><span class="p">,</span> <span class="s2">&quot;time_sec&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp_s_to_ms&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Row(unix_ts=1581540839000), Row(unix_ts=None), Row(unix_ts=None)]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><em>input</em>  in <strong>seconds</strong>
<em>output</em> in <strong>milli seconds</strong></p>
</div>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_timestamp_s_to_s">
<code class="descname">_generate_select_expression_for_timestamp_s_to_s</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_generate_select_expression_for_timestamp_s_to_s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_timestamp_s_to_s" title="Permalink to this definition">¶</a></dt>
<dd><p>This Constructor is used for unix timestamps. The values are cleaned
next to casting and renaming.
If the values are not between <cite>01.01.1970</cite> and <cite>31.12.2099</cite>,
NULL will be returned.
Cast to <a class="reference external" href="https://spark.apache.org/docs/2.4.3/api/python/pyspark.sql.html#pyspark.sql.types.LongType" title="(in PySpark vmaster)"><code class="xref any docutils literal notranslate"><span class="pre">pyspark.sql.types.LongType</span></code></a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spooq2.transformer</span> <span class="kn">import</span> <span class="n">Mapper</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Row</span><span class="p">(</span><span class="n">time_sec</span><span class="o">=</span><span class="mi">1581540839</span><span class="p">),</span>  <span class="c1"># 02/12/2020 @ 8:53pm (UTC)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Row</span><span class="p">(</span><span class="n">time_sec</span><span class="o">=-</span><span class="mi">4887839</span><span class="p">),</span>    <span class="c1"># Invalid!</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Row</span><span class="p">(</span><span class="n">time_sec</span><span class="o">=</span><span class="mi">4737139200</span><span class="p">)</span>   <span class="c1"># 02/12/2120 @ 12:00am (UTC)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;unix_ts&quot;</span><span class="p">,</span> <span class="s2">&quot;time_sec&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp_s_to_ms&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Row(unix_ts=1581540839), Row(unix_ts=None), Row(unix_ts=None)]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><em>input</em>  in <strong>seconds</strong>
<em>output</em> in <strong>seconds</strong></p>
</div>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_StringNull">
<code class="descname">_generate_select_expression_for_StringNull</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_generate_select_expression_for_StringNull"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_StringNull" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for Anonymizing.
Input values will be ignored and replaced by NULL,
Cast to <a class="reference external" href="https://spark.apache.org/docs/2.4.3/api/python/pyspark.sql.html#pyspark.sql.types.StringType" title="(in PySpark vmaster)"><code class="xref any docutils literal notranslate"><span class="pre">pyspark.sql.types.StringType</span></code></a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spooq2.transformer</span> <span class="kn">import</span> <span class="n">Mapper</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="n">Row</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;tsivorn1@who.int&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">Row</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">Row</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;gisaksen4@skype.com&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;email&quot;</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">,</span> <span class="s2">&quot;StringNull&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Row(email=None), Row(email=None), Row(email=None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_IntNull">
<code class="descname">_generate_select_expression_for_IntNull</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_generate_select_expression_for_IntNull"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_IntNull" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for Anonymizing.
Input values will be ignored and replaced by NULL,
Cast to <a class="reference external" href="https://spark.apache.org/docs/2.4.3/api/python/pyspark.sql.html#pyspark.sql.types.IntegerType" title="(in PySpark vmaster)"><code class="xref any docutils literal notranslate"><span class="pre">pyspark.sql.types.IntegerType</span></code></a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spooq2.transformer</span> <span class="kn">import</span> <span class="n">Mapper</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="n">Row</span><span class="p">(</span><span class="n">facebook_id</span><span class="o">=</span><span class="mi">3047288</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">Row</span><span class="p">(</span><span class="n">facebook_id</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">Row</span><span class="p">(</span><span class="n">facebook_id</span><span class="o">=</span><span class="mi">57815</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;facebook_id&quot;</span><span class="p">,</span> <span class="s2">&quot;facebook_id&quot;</span><span class="p">,</span> <span class="s2">&quot;IntNull&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Row(facebook_id=None), Row(facebook_id=None), Row(facebook_id=None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_StringBoolean">
<code class="descname">_generate_select_expression_for_StringBoolean</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_generate_select_expression_for_StringBoolean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_StringBoolean" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for Anonymizing.
The column’s value will be replaced by <cite>“1”</cite> if it is:</p>
<blockquote>
<div><ul class="simple">
<li>not NULL and</li>
<li>not an empty string</li>
</ul>
</div></blockquote>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spooq2.transformer</span> <span class="kn">import</span> <span class="n">Mapper</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="n">Row</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;tsivorn1@who.int&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">Row</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">Row</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;gisaksen4@skype.com&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;email&quot;</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">,</span> <span class="s2">&quot;StringBoolean&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Row(email=u&#39;1&#39;), Row(email=None), Row(email=u&#39;1&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_IntBoolean">
<code class="descname">_generate_select_expression_for_IntBoolean</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_generate_select_expression_for_IntBoolean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_IntBoolean" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for Anonymizing.
The column’s value will be replaced by <cite>1</cite> if it contains a non-NULL value.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spooq2.transformer</span> <span class="kn">import</span> <span class="n">Mapper</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="n">Row</span><span class="p">(</span><span class="n">facebook_id</span><span class="o">=</span><span class="mi">3047288</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">Row</span><span class="p">(</span><span class="n">facebook_id</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">Row</span><span class="p">(</span><span class="n">facebook_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;facebook_id&quot;</span><span class="p">,</span> <span class="s2">&quot;facebook_id&quot;</span><span class="p">,</span> <span class="s2">&quot;IntBoolean&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Row(facebook_id=1), Row(facebook_id=1), Row(facebook_id=None)]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><cite>0</cite> (zero) or negative numbers are still considered as valid values and therefore converted to <cite>1</cite>.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_TimestampMonth">
<code class="descname">_generate_select_expression_for_TimestampMonth</code><span class="sig-paren">(</span><em>source_column</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spooq2/transformer/mapper_custom_data_types.html#_generate_select_expression_for_TimestampMonth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spooq2.transformer.mapper_custom_data_types._generate_select_expression_for_TimestampMonth" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for Anonymizing. Can be used to keep the age but obscure the explicit birthday.
This custom datatype requires a <a class="reference external" href="https://spark.apache.org/docs/2.4.3/api/python/pyspark.sql.html#pyspark.sql.types.TimestampType" title="(in PySpark vmaster)"><code class="xref any docutils literal notranslate"><span class="pre">pyspark.sql.types.TimestampType</span></code></a> column as input.
The datetime value will be set to the first day of the month.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spooq2.transformer</span> <span class="kn">import</span> <span class="n">Mapper</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="n">Row</span><span class="p">(</span><span class="n">birthday</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">45</span><span class="p">)),</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">Row</span><span class="p">(</span><span class="n">birthday</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">Row</span><span class="p">(</span><span class="n">birthday</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1988</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">8</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;birthday&quot;</span><span class="p">,</span> <span class="s2">&quot;birthday&quot;</span><span class="p">,</span> <span class="s2">&quot;TimestampMonth&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Row(birthday=datetime.datetime(2019, 2, 1, 0, 0)),</span>
<span class="go"> Row(birthday=None),</span>
<span class="go"> Row(birthday=datetime.datetime(1988, 1, 1, 0, 0))]</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="threshold_cleaner.html" class="btn btn-neutral float-right" title="Threshold-based Cleaner" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sieve.html" class="btn btn-neutral float-left" title="Sieve (Filter)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, David Eigenstuhler

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>